<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Animation Demo</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- STAR FIELD (canvas-based for performance) -->
  <canvas id="star-field" aria-hidden="true"></canvas>

  <!-- PASSWORD SCREEN -->
  <div id="lockScreen">
    <h1 class="login_title">请输入密码</h1>
    <input type="password" id="passwordInput" placeholder="密码">
    <br><br>
    <button onclick="checkPassword()">确认</button>
    <p id="errorText" style="color:red"></p>
  </div>
  
  <!-- LOADING SCREEN -->
  <div id="loadingScreen" class="loading" style="display:none;">
    <svg width="64px" height="48px" aria-hidden="true">
      <polyline points="0.157 23.954, 14 23.954, 21.843 48, 43 0, 50 24, 64 24" id="back"></polyline>
      <polyline points="0.157 23.954, 14 23.954, 21.843 48, 43 0, 50 24, 64 24" id="front"></polyline>
    </svg>
  </div>

  <!-- REAL CONTENT (LOCKED) -->
  <div id="content" style="display:none;">
      <section class="typing-group p" id="section1">
              <button class="scroll-button">
                  <span>下</span>
                  <span>一</span>
                  <span>页</span>
                  <span class="arrow">↓</span>
              </button>        
              <div class="container">
                  
                  <h1>
                      <span class="typing thin title" data-speed="60">2025</span>
                      <span class="typing title" data-speed="60">年快要结束了</span>
                  </h1>
                  <div class="text_container" data-speed="30">
                      <span class="quote">“</span>
                      <p class="typing" >
                          生日快乐，我的小捣蛋！<!-- 记录 No.01：她出现的那天 -->
                      </p>
                      <br>
                      <p class="typing">
                          时光荏苒，转眼间这是我们在一起的200多天。
                      </p>
                      <br>
                      <p class="typing">
                          她总是走神，总有那么多小动作让我发笑。
                          <img src="emoji/s264.gif" alt="笑脸" class="emoji delayed">
                      </p>
                      <br>
                      <p class="typing">
                          每一次让我哭笑不得的反应，
                      </p>
                      <br>
                      <p class="typing">
                          我想记录下她的一切, 她不知道的, 她没注意到的，
                          还有那些重要且有意义的瞬间。               
                      </p>
                      
                      <span class="quote-right">”</span>
                  </div>
                </div>
    
    </section>

      <section class="typing-group h1" id="section2">
      <h1>
        <span class="typing thin title" data-speed="60">2025</span>
        <span class="typing title" data-speed="60">年快结束了</span>
        <button class="scroll-button">
          <span>下</span>
          <span>一</span>
          <span>页</span>
          <span id="arrow">↓</span>
        </button>
      </h1>

      <p class="typing" data-speed="40">
        记录 No.01：她出现的那天
      </p>

      <p class="typing">
        This is third
      </p>

      <p class="typing">
        This is third
      </p>
    </section>  

      <section class="typing-group h1" id="section3">
      <h1>
        <span class="typing thin title" data-speed="60">2025</span>
        <span class="typing title" data-speed="60">年快结束了</span>
        <button class="scroll-button">
          <span>下</span>
          <span>一</span>
          <span>页</span>
          <span id="arrow">↓</span>
        </button>
      </h1>

      <p class="typing" data-speed="40">
        记录 No.01：她出现的那天
      </p>

      <p class="typing">
        This is third
      </p>

      <p class="typing">
        This is third
      </p>
    </section>  

      <section class="typing-group h1" id="section4">
      <h1>
        <span class="typing thin title" data-speed="60">2025</span>
        <span class="typing title" data-speed="60">年快结束了</span>
        <button class="scroll-button">
          <span>下</span>
          <span>一</span>
          <span>页</span>
          <span id="arrow">↓</span>
        </button>
      </h1>

      <p class="typing" data-speed="40">
        记录 No.01：她出现的那天
      </p>

      <p class="typing">
        This is third
      </p>

      <p class="typing">
        This is third
      </p>
    </section>  
  </div>

<!-- Password + trigger typing -->
<script>
function checkPassword() {
  const input = document.getElementById("passwordInput").value;
  const correctPassword = "1";

  const btn = document.querySelector('#lockScreen button');
  const lockScreen = document.getElementById("lockScreen");
  const loader = document.getElementById("loadingScreen");
  const content = document.getElementById("content");

  // Configurable delays
  const pressedDelay = 500; // how long pressed state is visible (ms)
  const minLoader = 2000;   // minimum loader duration (ms)

  // --- WRONG PASSWORD ---
  if (input !== correctPassword) {
    document.getElementById("errorText").innerText = "Wrong password";
    btn.classList.remove('pressed');
    return;
  }

  // --- CORRECT PASSWORD ---
  btn.classList.add('pressed');

  // ensure pressed state shown
  requestAnimationFrame(() => {
    setTimeout(() => {
      lockScreen.style.display = "none";
      loader.style.display = "flex";
      const loaderStart = Date.now();

      document.fonts.ready.then(() => {
        const elapsed = Date.now() - loaderStart;
        const remaining = Math.max(minLoader - elapsed, 0);

        setTimeout(() => {
          loader.style.display = "none";
          content.style.display = "block";
          btn.classList.remove('pressed');
          // trigger a resize event to let canvas adapt
          window.dispatchEvent(new Event('resize'));
        }, remaining);
      });
    }, pressedDelay);
  });
}
</script>

<script src="anim.js"></script>
</body>
</html>
